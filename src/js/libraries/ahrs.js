/**
 * Bundled by jsDelivr using Rollup v2.79.2 and Terser v5.39.0.
 * Original file: /npm/ahrs@1.3.3/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var t=function(t,n){const a=(n=n||{}).kp||1,o=n.ki||0;let i=1/(1e3/t),e=!0!==n.doInitialisation,h=2*a;const c=2*o;let r=1,s=0,l=0,u=0,M=0,y=0,g=0;function d(t,n,a,o,i,e){return{x:n*e-a*i,y:a*o-t*e,z:t*i-n*o}}function f(t,n,a,o,i,h){const c=function(t,n,a,o,i,e){const h=-Math.atan2(t,Math.sqrt(n*n+a*a)),c=d(t,n,a,1,0,0),r=d(1,0,0,c.x,c.y,c.z),s=Math.atan2(r.y,r.z),l=Math.cos(s),u=Math.sin(h),M=Math.sin(s),y=i*l-e*M,g=o*Math.cos(h)+i*M*u+e*l*u;return{heading:-Math.atan2(y,g),pitch:h,roll:s}}(t,n,a,o,i,h),M=function(t){const n=Math.cos(.5*t.heading),a=Math.sin(.5*t.heading),o=Math.cos(.5*t.pitch),i=Math.sin(.5*t.pitch),e=Math.cos(.5*t.roll),h=Math.sin(.5*t.roll);return{w:e*o*n+h*i*a,x:h*o*n-e*i*a,y:e*i*n+h*o*a,z:e*o*a-h*i*n}}(c),y=(M.w*M.w+M.x*M.x+M.y*M.y+M.z*M.z)**-.5;r=M.w*y,s=M.x*y,l=M.y*y,u=M.z*y,e=!0}return{update:function(t,n,a,o,d,z,x,p,w,v){let k,A,E,q,I,Q,m,b,j,D,H,O,P,R,S,V,$,B,C,F,G,J,K,L;if(i=v||i,e||f(o,d,z,x,p,w),void 0===x||void 0===p||void 0===w||0===x&&0===p&&0===w)return void function(t,n,a,o,e,d){let f,z,x,p,w,v,k;0!==o&&0!==e&&0!==d&&(f=(o*o+e*e+d*d)**-.5,z=s*u-r*l,x=r*s+l*u,p=r*r-.5+u*u,w=(e*=f)*p-(d*=f)*x,v=d*z-(o*=f)*p,k=o*x-e*z,c>0?(M+=c*w*i,y+=c*v*i,g+=c*k*i,t+=M,n+=y,a+=g):(M=0,y=0,g=0),t+=h*w,n+=h*v,a+=h*k);const A=r,E=s,q=l;r+=-E*(t*=.5*i)-q*(n*=.5*i)-u*(a*=.5*i),s+=A*t+q*a-u*n,l+=A*n-E*a+u*t,u+=A*a+E*n-q*t,f=(r*r+s*s+l*l+u*u)**-.5,r*=f,s*=f,l*=f,u*=f}(t,n,a,o,d,z);0!==o&&0!==d&&0!==z&&(k=(o*o+d*d+z*z)**-.5,o*=k,d*=k,z*=k,k=(x*x+p*p+w*w)**-.5,A=r*r,E=r*s,q=r*l,I=r*u,Q=s*s,m=s*l,b=s*u,j=l*l,D=l*u,H=u*u,O=2*((x*=k)*(.5-j-H)+(p*=k)*(m-I)+(w*=k)*(b+q)),P=2*(x*(m+I)+p*(.5-Q-H)+w*(D-E)),R=Math.sqrt(O*O+P*P),S=2*(x*(b-q)+p*(D+E)+w*(.5-Q-j)),V=b-q,$=E+D,B=A-.5+H,C=R*(.5-j-H)+S*(b-q),F=R*(m-I)+S*(E+D),G=R*(q+b)+S*(.5-Q-j),J=d*B-z*$+(p*G-w*F),K=z*V-o*B+(w*C-x*G),L=o*$-d*V+(x*F-p*C),c>0?(M+=c*J*i,y+=c*K*i,g+=c*L*i,t+=M,n+=y,a+=g):(M=0,y=0,g=0),t+=h*J,n+=h*K,a+=h*L);const N=r,T=s,U=l;r+=-T*(t*=.5*i)-U*(n*=.5*i)-u*(a*=.5*i),s+=N*t+U*a-u*n,l+=N*n-T*a+u*t,u+=N*a+T*n-U*t,k=(r*r+s*s+l*l+u*u)**-.5,r*=k,s*=k,l*=k,u*=k},init:f,getQuaternion:()=>({w:r,x:s,y:l,z:u})}},n=function(t,n){const a=1e3/t;let o=(n=n||{}).beta||.4,i=!0!==n.doInitialisation,e=1,h=0,c=0,r=0,s=1/a;function l(t,n,a,o,i,e){return{x:n*e-a*i,y:a*o-t*e,z:t*i-n*o}}function u(t,n,a,o,s,u){const M=function(t,n,a,o,i,e){const h=-Math.atan2(t,Math.sqrt(n*n+a*a)),c=l(t,n,a,1,0,0),r=l(1,0,0,c.x,c.y,c.z),s=Math.atan2(r.y,r.z),u=Math.cos(s),M=Math.sin(h),y=Math.sin(s),g=i*u-e*y,d=o*Math.cos(h)+i*y*M+e*u*M;return{heading:-Math.atan2(g,d),pitch:h,roll:s}}(t,n,a,o,s,u),y=function(t){const n=Math.cos(.5*t.heading),a=Math.sin(.5*t.heading),o=Math.cos(.5*t.pitch),i=Math.sin(.5*t.pitch),e=Math.cos(.5*t.roll),h=Math.sin(.5*t.roll);return{w:e*o*n+h*i*a,x:h*o*n-e*i*a,y:e*i*n+h*o*a,z:e*o*a-h*i*n}}(M),g=(y.w*y.w+y.x*y.x+y.y*y.y+y.z*y.z)**-.5;e=y.w*g,h=y.x*g,c=y.y*g,r=y.z*g,i=!0}return{update:function(t,n,a,l,M,y,g,d,f,z){let x,p,w,v,k,A,E,q,I,Q,m,b,j,D,H,O,P,R,S,V,$,B,C,F,G,J,K,L,N,T,U,W,X,Y,Z;s=z||s,i||u(l,M,y,g,d,f),void 0===g||void 0===d||void 0===f||0===g&&0===d&&0===f?function(t,n,a,i,l,u){let M,y,g,d,f,z,x,p,w,v,k,A,E,q,I,Q,m,b,j,D,H,O;z=.5*(-h*t-c*n-r*a),x=.5*(e*t+c*a-r*n),p=.5*(e*n-h*a+r*t),w=.5*(e*a+h*n-c*t),0===i&&0===l&&0===u||(M=(i*i+l*l+u*u)**-.5,v=2*e,k=2*h,A=2*c,E=2*r,q=4*e,I=4*h,Q=4*c,m=8*h,b=8*c,j=e*e,D=h*h,H=c*c,O=r*r,y=q*H+A*(i*=M)+q*D-k*(l*=M),g=I*O-E*i+4*j*h-v*l-I+m*D+m*H+I*(u*=M),d=4*j*c+v*i+Q*O-E*l-Q+b*D+b*H+Q*u,f=4*D*r-k*i+4*H*r-A*l,M=(y*y+g*g+d*d+f*f)**-.5,y*=M,g*=M,d*=M,f*=M,z-=o*y,x-=o*g,p-=o*d,w-=o*f),e+=z*s,h+=x*s,c+=p*s,r+=w*s,M=(e*e+h*h+c*c+r*r)**-.5,e*=M,h*=M,c*=M,r*=M}(t,n,a,l,M,y):(A=.5*(-h*t-c*n-r*a),E=.5*(e*t+c*a-r*n),q=.5*(e*n-h*a+r*t),I=.5*(e*a+h*n-c*t),0===l&&0===M&&0===y||(x=(l*l+M*M+y*y)**-.5,l*=x,M*=x,y*=x,x=(g*g+d*d+f*f)**-.5,b=2*e*(g*=x),j=2*e*(d*=x),D=2*e*(f*=x),H=2*h*g,V=2*e,$=2*h,B=2*c,C=2*r,F=2*e*c,G=2*c*r,J=e*e,K=e*h,L=e*c,N=e*r,T=h*h,U=h*c,W=h*r,X=c*c,Y=c*r,Z=r*r,Q=g*J-j*r+D*c+g*T+$*d*c+$*f*r-g*X-g*Z,m=b*r+d*J-D*h+H*c-d*T+d*X+B*f*r-d*Z,O=Math.sqrt(Q*Q+m*m),P=-b*c+j*h+f*J+H*r-f*T+B*d*r-f*X+f*Z,R=2*O,S=2*P,p=-B*(2*W-F-l)+$*(2*K+G-M)-P*c*(O*(.5-X-Z)+P*(W-L)-g)+(-O*r+P*h)*(O*(U-N)+P*(K+Y)-d)+O*c*(O*(L+W)+P*(.5-T-X)-f),w=C*(2*W-F-l)+V*(2*K+G-M)-4*h*(1-2*T-2*X-y)+P*r*(O*(.5-X-Z)+P*(W-L)-g)+(O*c+P*e)*(O*(U-N)+P*(K+Y)-d)+(O*r-S*h)*(O*(L+W)+P*(.5-T-X)-f),v=-V*(2*W-F-l)+C*(2*K+G-M)-4*c*(1-2*T-2*X-y)+(-R*c-P*e)*(O*(.5-X-Z)+P*(W-L)-g)+(O*h+P*r)*(O*(U-N)+P*(K+Y)-d)+(O*e-S*c)*(O*(L+W)+P*(.5-T-X)-f),k=$*(2*W-F-l)+B*(2*K+G-M)+(-R*r+P*h)*(O*(.5-X-Z)+P*(W-L)-g)+(-O*e+P*c)*(O*(U-N)+P*(K+Y)-d)+O*h*(O*(L+W)+P*(.5-T-X)-f),x=(p*p+w*w+v*v+k*k)**-.5,p*=x,w*=x,v*=x,k*=x,A-=o*p,E-=o*w,q-=o*v,I-=o*k),e+=A*s,h+=E*s,c+=q*s,r+=I*s,x=(e*e+h*h+c*c+r*r)**-.5,e*=x,h*=x,c*=x,r*=x)},init:u,getQuaternion:()=>({w:e,x:h,y:c,z:r})}};const a=180/Math.PI;function o(a){const o=(a=a||{}).sampleInterval||20,i=a.algorithm||"Madgwick";let e;if("Mahony"===i)e=t;else{if("Madgwick"!==i)throw new Error(`AHRS(): Algorithm not valid: ${i}`);e=n}const h=e(o,a),c=this;Object.keys(h).forEach((t=>c[t]=h[t]))}o.prototype.toVector=function(){const t=this.getQuaternion(),n=2*Math.acos(t.w),a=Math.sin(n/2);return{angle:n,x:t.x/a,y:t.y/a,z:t.z/a}},o.prototype.getEulerAngles=function(){const t=this.getQuaternion(),n=t.w*t.w,a=t.x*t.x,o=t.y*t.y,i=t.z*t.z;return{heading:Math.atan2(2*(t.x*t.y+t.z*t.w),a-o-i+n),pitch:-Math.asin(2*(t.x*t.z-t.y*t.w)),roll:Math.atan2(2*(t.y*t.z+t.x*t.w),-a-o+i+n)}},o.prototype.getEulerAnglesDegrees=function(){const t=this.getEulerAngles();return{heading:t.heading*a,pitch:t.pitch*a,roll:t.roll*a}};var i=o;export{i as default};
//# sourceMappingURL=/sm/b65d69029fa5a80afa84ef9befa455dcbff07d6f4b8994441e4310c114aea1c5.map